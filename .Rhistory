######
# 2015
#####
load("C:/Users/avand/Documents/unmarked/2015_models.Rdata")
m15 <- model
names15 <- names(m15)
cov15 <- read.csv("C:/Users/avand/Documents/data/2015_cov.csv")
###
## mod avg
###
modavg15s <- modavg(m15, parm="scale_short", parm.type="lambda")
modavg15i <- modavg(m15, parm="scale_int", parm.type="lambda") #NOT
modavg15w <- modavg(m15, parm="scale_averagewater", parm.type="lambda", exclude=list("~scale_averagewater+scale_averagewater2"))
modavg15p <- modavg(m15, parm="scale_pe", parm.type="lambda") #NOT
## averagewater
scale_averagewater15 <- data.frame(scale_averagewater=seq(min(cov15$scale_averagewater), max(cov15$scale_averagewater), length.out=50),scale_short=mean(cov15$scale_short), scale_int=mean(cov15$scale_int), averagewater=seq(min(cov15$averagewater), max(cov15$averagewater), length.out=50),scale_pe=mean(cov15$scale_pe))
scale_averagewater15$scale_averagewater2 <- scale_averagewater15$scale_averagewater^2
Modnames <- names(m15)
pred_averagewater_15 <- modavgPred(cand.set=m15, modnames=Modnames,newdata=scale_averagewater15, parm.type="lambda",type="response", uncond.se="old")
averagewater15 <- cbind(scale_averagewater15, pred_averagewater_15)
averagewater15$sd <- averagewater15$uncond.se * sqrt(50)
averagewater15$ci <- qnorm(0.975)*averagewater15$sd/sqrt(50)
averagewater15$upper <- averagewater15$mod.avg.pred + averagewater15$ci
averagewater15$lower <- averagewater15$mod.avg.pred - averagewater15$ci
(w15 <- ggplot()+theme_krementz()+ylab("Sora per hectare")+xlab("Average Water Depth (cm)")+
geom_ribbon(data=averagewater15, aes(x=averagewater, ymax=upper, ymin=lower), fill="gray", color="black")+
geom_line(data=averagewater15, aes(x=averagewater, y=mod.avg.pred))+ggtitle("2015"))
## short
scale_short15 <- data.frame(scale_short=seq(min(cov15$scale_short), max(cov15$scale_short), length.out=50),scale_averagewater=0, scale_averagewater2=0, scale_int=mean(cov15$scale_int), short=seq(min(cov15$short), max(cov15$short), length.out=50),scale_pe=mean(cov15$scale_pe))
Modnames <- names(m15)
p15 <- bup(ranef(m15$`~scale_short`), type="mean")
p15
pred_short_15 <- modavgPred(cand.set=m15, modnames=Modnames,newdata=scale_short15, parm.type="lambda",type="response", uncond.se="old")
short15 <- cbind(scale_short15, pred_short_15)
short15$sd <- short15$uncond.se * sqrt(50)
short15$ci <- qnorm(0.975)*short15$sd/sqrt(50)
short15$upper <- short15$mod.avg.pred + short15$ci
short15$lower <- short15$mod.avg.pred - short15$ci
(s15 <- ggplot()+theme_krementz()+ylab("Sora per hectare")+xlab("Percent Cover Non Presistent \nMoist Soil Vegetation")+
geom_ribbon(data=short15, aes(x=short, ymax=upper, ymin=lower), fill="gray", color="black")+
geom_line(data=short15, aes(x=short, y=mod.avg.pred))+ggtitle("2015"))
#png(filename="~/manuscripts/Dissertation_Chapter_2_Habitat_Sora/figure_1_betas.png", height=1000, width=600)
grid.arrange(s12, i13, w14, w15, s15, ncol=1)
#dev.off()
(s15 <- ggplot()+theme_krementz()+ylab("Sora per hectare")+xlab("Average Water Depth (cm)")+
geom_line(data=short15, aes(x=short, y=upper),linetype=2, color="black")+
geom_line(data=short15, aes(x=short, y=lower),linetype=2, color="black")+
geom_line(data=short15, aes(x=short, y=mod.avg.pred), lwd=2)+ggtitle("2015"))
(w15 <- ggplot()+theme_krementz()+ylab("Sora per hectare")+xlab("Average Water Depth (cm)")+
geom_line(data=averagewater15, aes(x=averagewater, y=upper),linetype=2, color="black")+
geom_line(data=averagewater15, aes(x=averagewater, y=lower),linetype=2, color="black")+
geom_line(data=averagewater15, aes(x=averagewater, y=mod.avg.pred), lwd=2)+ggtitle("2015"))
grid.arrange(s12, i13, w14, w15, s15, ncol=1)
library(ggplot2)
library(DMwR)
library(unmarked)
library(auriel)
library(AICcmodavg)
library(gridExtra)
## model averages not commented out are significantly different than zero
### 2012
load("C:/Users/avand/Documents/unmarked/2012_models.Rdata")
m12 <- model
cov12 <- read.csv("C:/Users/avand/Documents/data/2012_cov.csv")
###
## mod avg
###
modavg12s <- modavg(m12, parm="scale_short", parm.type="lambda")
modavg12i <- modavg(m12, parm="scale_int", parm.type="lambda") #NOT
modavg12w <- modavg(m12, parm="scale_averagewater", parm.type="lambda", exclude=list("~scale_averagewater+scale_averagewater2")) #NOT
## short
scale_short12 <- data.frame(scale_short=seq(min(cov12$scale_short), max(cov12$scale_short), length.out=50),scale_averagewater=mean(cov12$scale_averagewater), scale_averagewater2=mean(cov12$averagewater)^2, scale_int=mean(cov12$scale_int), short=seq(min(cov12$short), max(cov12$short), length.out=50))
Modnames <- names(m12)
pred_short_12 <- modavgPred(cand.set=m12, modnames=Modnames,newdata=scale_short12, parm.type="lambda",type="response", uncond.se="old")
short12 <- cbind(scale_short12, pred_short_12)
short12$sd <- short12$uncond.se * sqrt(50)
short12$ci <- qnorm(0.975)*short12$sd/sqrt(50)
short12$upper <- short12$mod.avg.pred + short12$ci
short12$lower <- short12$mod.avg.pred - short12$ci
(s12 <- ggplot()+theme_krementz()+ylab("2012 \nSora per hectare")+xlab("Percent Cover Non Presistent \nMoist Soil Vegetation")+
geom_line(data=short12, aes(x=short, y=upper), color="black", linetype=2)+
geom_line(data=short12, aes(x=short, y=lower), color="black", linetype=2)+
geom_line(data=short12, aes(x=short, y=mod.avg.pred),lwd=2))
#####
# 2013
######
load("C:/Users/avand/Documents/unmarked/2013_models.Rdata")
m13 <- model
cov13 <- read.csv("C:/Users/avand/Documents/data/2013_cov.csv")
###
## mod avg
###
modavg13s <- modavg(m13, parm="scale_short", parm.type="lambda") #NOT
modavg13i <- modavg(m13, parm="scale_int", parm.type="lambda")
modavg13w <- modavg(m13, parm="scale_averagewater", parm.type="lambda", exclude=list("~scale_averagewater+scale_averagewater2")) #NOT
modavg13p <- modavg(m13, parm="scale_pe", parm.type="lambda") #NOT
## in
scale_int13 <- data.frame(scale_int=seq(min(cov13$scale_int), max(cov13$scale_int), length.out=50),scale_averagewater=mean(cov13$scale_averagewater), scale_averagewater2=mean(cov13$averagewater)^2, scale_short=mean(cov13$scale_short), int=seq(min(cov13$int), max(cov13$int), length.out=50), scale_pe=mean(cov14$scale_pe))
scale_int13$int <- scale_int13$int*100
Modnames <- names(m13)
predint13 <- predict(m12$"~scale_int",
newdata=scale_int13, type="lambda")
int13 <- cbind(predint13, scale_int13)
int13$sd <- int13$SE * sqrt(nrow(cov13))
int13$upper <- int13$Predicted + qnorm(0.975)*int13$sd/sqrt(nrow(cov13))
(i13 <- ggplot()+theme_krementz()+ylab("2013 \nSora per hectare")+xlab("Percent Interspersion")+
geom_line(data=int13, aes(x=int, y=upper), linetype=2, color="black")+
geom_line(data=int13, aes(x=int, y=lower), linetype=2, color="black")+
geom_line(data=int13, aes(x=int, y=Predicted),lwd=2)
####
## 2014
####
load("C:/Users/avand/Documents/unmarked/2014_p_models.Rdata")
m14 <- model
names14 <- names(m14)
cov14 <- read.csv("C:/Users/avand/Documents/data/2014_cov.csv")
###
## mod avg
###
modavg14s <- modavg(m14, parm="scale_short", parm.type="lambda") #NOT
modavg14i <- modavg(m14, parm="scale_int", parm.type="lambda") #NOT
modavg14w <- modavg(m14, parm="scale_averagewater", parm.type="lambda", exclude=list("~scale_averagewater+scale_averagewater2"))
modavg14p <- modavg(m14, parm="scale_pe", parm.type="lambda") #NOT
## averagewater
scale_averagewater14 <- data.frame(scale_averagewater=seq(min(cov14$scale_averagewater), max(cov14$scale_averagewater), length.out=50),scale_short=mean(cov14$scale_short), scale_int=mean(cov14$scale_int), averagewater=seq(min(cov14$averagewater), max(cov14$averagewater), length.out=50),scale_pe=mean(cov14$scale_pe))
scale_averagewater14$scale_averagewater2 <- scale_averagewater14$scale_averagewater^2
Modnames <- names(m14)
pred_averagewater_14 <- modavgPred(cand.set=m14, modnames=Modnames,newdata=scale_averagewater14, parm.type="lambda",type="response", uncond.se="old")
averagewater14 <- cbind(scale_averagewater14, pred_averagewater_14)
averagewater14$sd <- averagewater14$uncond.se * sqrt(50)
averagewater14$ci <- qnorm(0.975)*averagewater14$sd/sqrt(50)
averagewater14$upper <- averagewater14$mod.avg.pred + averagewater14$ci
averagewater14$lower <- averagewater14$mod.avg.pred - averagewater14$ci
(w14 <- ggplot()+theme_krementz()+ylab("2014 \nSora per hectare")+xlab("Average Water Depth (cm)")+
geom_line(data=averagewater14, aes(x=averagewater, y=upper),linetype=2, color="black")+
geom_line(data=averagewater14, aes(x=averagewater, y=lower),linetype=2, color="black")+
geom_line(data=averagewater14, aes(x=averagewater, y=mod.avg.pred), lwd=2))
######
# 2015
#####
load("C:/Users/avand/Documents/unmarked/2015_models.Rdata")
m15 <- model
names15 <- names(m15)
cov15 <- read.csv("C:/Users/avand/Documents/data/2015_cov.csv")
###
## mod avg
###
modavg15s <- modavg(m15, parm="scale_short", parm.type="lambda")
modavg15i <- modavg(m15, parm="scale_int", parm.type="lambda") #NOT
modavg15w <- modavg(m15, parm="scale_averagewater", parm.type="lambda", exclude=list("~scale_averagewater+scale_averagewater2"))
modavg15p <- modavg(m15, parm="scale_pe", parm.type="lambda") #NOT
## averagewater
scale_averagewater15 <- data.frame(scale_averagewater=seq(min(cov15$scale_averagewater), max(cov15$scale_averagewater), length.out=50),scale_short=mean(cov15$scale_short), scale_int=mean(cov15$scale_int), averagewater=seq(min(cov15$averagewater), max(cov15$averagewater), length.out=50),scale_pe=mean(cov15$scale_pe))
scale_averagewater15$scale_averagewater2 <- scale_averagewater15$scale_averagewater^2
Modnames <- names(m15)
pred_averagewater_15 <- modavgPred(cand.set=m15, modnames=Modnames,newdata=scale_averagewater15, parm.type="lambda",type="response", uncond.se="old")
averagewater15 <- cbind(scale_averagewater15, pred_averagewater_15)
averagewater15$sd <- averagewater15$uncond.se * sqrt(50)
averagewater15$ci <- qnorm(0.975)*averagewater15$sd/sqrt(50)
averagewater15$upper <- averagewater15$mod.avg.pred + averagewater15$ci
averagewater15$lower <- averagewater15$mod.avg.pred - averagewater15$ci
(w15 <- ggplot()+theme_krementz()+ylab("2015 \nSora per hectare")+xlab("Average Water Depth (cm)")+
geom_line(data=averagewater15, aes(x=averagewater, y=upper),linetype=2, color="black")+
geom_line(data=averagewater15, aes(x=averagewater, y=lower),linetype=2, color="black")+
geom_line(data=averagewater15, aes(x=averagewater, y=mod.avg.pred), lwd=2))
## short
scale_short15 <- data.frame(scale_short=seq(min(cov15$scale_short), max(cov15$scale_short), length.out=50),scale_averagewater=0, scale_averagewater2=0, scale_int=mean(cov15$scale_int), short=seq(min(cov15$short), max(cov15$short), length.out=50),scale_pe=mean(cov15$scale_pe))
Modnames <- names(m15)
p15 <- bup(ranef(m15$`~scale_short`), type="mean")
p15
pred_short_15 <- modavgPred(cand.set=m15, modnames=Modnames,newdata=scale_short15, parm.type="lambda",type="response", uncond.se="old")
short15 <- cbind(scale_short15, pred_short_15)
short15$sd <- short15$uncond.se * sqrt(50)
short15$ci <- qnorm(0.975)*short15$sd/sqrt(50)
short15$upper <- short15$mod.avg.pred + short15$ci
short15$lower <- short15$mod.avg.pred - short15$ci
(s15 <- ggplot()+theme_krementz()+ylab("2015 \nSora per hectare")+xlab("Average Water Depth (cm)")+
geom_line(data=short15, aes(x=short, y=upper),linetype=2, color="black")+
geom_line(data=short15, aes(x=short, y=lower),linetype=2, color="black")+
geom_line(data=short15, aes(x=short, y=mod.avg.pred), lwd=2))
#png(filename="~/manuscripts/Dissertation_Chapter_2_Habitat_Sora/figure_1_betas.png", height=1000, width=600)
grid.arrange(s12, i13, w14, w15, s15, ncol=1)
#dev.off()
(i13 <- ggplot()+theme_krementz()+ylab("2013 \nSora per hectare")+xlab("Percent Interspersion")+
geom_line(data=int13, aes(x=int, y=upper), linetype=2, color="black")+
geom_line(data=int13, aes(x=int, y=lower), linetype=2, color="black")+
geom_line(data=int13, aes(x=int, y=Predicted),lwd=2))
grid.arrange(s12, i13, w14, w15, s15, ncol=1)
grid.arrange(s12, i13, w14, w15, s15, ncol=2)
grid.arrange(s12, s15, i13, w15, w14, ncol=2)
(s15 <- ggplot()+theme_krementz()+ylab("2015 \nSora per hectare")+xlab("Percent Cover Non Persistent \nMoist Soil Vegetation")+
geom_line(data=short15, aes(x=short, y=upper),linetype=2, color="black")+
geom_line(data=short15, aes(x=short, y=lower),linetype=2, color="black")+
geom_line(data=short15, aes(x=short, y=mod.avg.pred), lwd=2))
grid.arrange(s12, s15, i13, w15, w14, ncol=2)
w14
load("C:/Users/avand/Documents/unmarked/2014_models.Rdata")
m14 <- model
names14 <- names(m14)
cov14 <- read.csv("C:/Users/avand/Documents/data/2014_cov.csv")
###
## mod avg
###
modavg14s <- modavg(m14, parm="scale_short", parm.type="lambda") #NOT
modavg14i <- modavg(m14, parm="scale_int", parm.type="lambda") #NOT
modavg14w <- modavg(m14, parm="scale_averagewater", parm.type="lambda", exclude=list("~scale_averagewater+scale_averagewater2"))
modavg14p <- modavg(m14, parm="scale_pe", parm.type="lambda") #NOT
## averagewater
scale_averagewater14 <- data.frame(scale_averagewater=seq(min(cov14$scale_averagewater), max(cov14$scale_averagewater), length.out=50),scale_short=mean(cov14$scale_short), scale_int=mean(cov14$scale_int), averagewater=seq(min(cov14$averagewater), max(cov14$averagewater), length.out=50),scale_pe=mean(cov14$scale_pe))
scale_averagewater14$scale_averagewater2 <- scale_averagewater14$scale_averagewater^2
Modnames <- names(m14)
pred_averagewater_14 <- modavgPred(cand.set=m14, modnames=Modnames,newdata=scale_averagewater14, parm.type="lambda",type="response", uncond.se="old")
averagewater14 <- cbind(scale_averagewater14, pred_averagewater_14)
averagewater14$sd <- averagewater14$uncond.se * sqrt(50)
averagewater14$ci <- qnorm(0.975)*averagewater14$sd/sqrt(50)
averagewater14$upper <- averagewater14$mod.avg.pred + averagewater14$ci
averagewater14$lower <- averagewater14$mod.avg.pred - averagewater14$ci
(w14 <- ggplot()+theme_krementz()+ylab("2014 \nSora per hectare")+xlab("Average Water Depth (cm)")+
geom_line(data=averagewater14, aes(x=averagewater, y=upper),linetype=2, color="black")+
geom_line(data=averagewater14, aes(x=averagewater, y=lower),linetype=2, color="black")+
geom_line(data=averagewater14, aes(x=averagewater, y=mod.avg.pred), lwd=2))
mm14
model
mm14
list  = fitList(model)
mm14 = modSel(list)
mm14
models <- c("~1",
"~scale_averagewater",
"~scale_averagewater+scale_averagewater2",
"~scale_short",
"~scale_int",
"~scale_short+scale_int",
"~scale_pe")
library(unmarked)
sora <- read.csv('C:/Users/avand/Documents/data/2014_sora.csv', header=T)
cov <- read.csv('C:/Users/avand/Documents/data/2014_cov.csv', header=T)
sora <- sora[order(sora$impound),]
cov <- cov[order(cov$impound),]
cov$scale_short2 <- cov$scale_short^2
cov$scale_int2 <- cov$scale_int^2
cov$scale_averagewater2 <- cov$scale_averagewater^2
sora <- sora[,2:11]
cutpt = as.numeric(c(0,1,2,3,4,5))
umf = unmarkedFrameGDS(y=sora,
numPrimary=2,
siteCovs = cov,
survey="line",
dist.breaks=cutpt,
unitsIn="m",
tlength=cov$length
)
model <- list()
for(i in 1:length(models)){
print(i)
model[[models[[i]]]] = gdistsamp(lambdaformula = as.formula(models[i]),
phiformula = ~1,
pformula = ~1,
data = umf, keyfun = "hazard", mixture="NB",se = T, output="abund")
}
model$global <- gdistsamp(lambdaformula = ~scale_short+scale_averagewater+scale_pe+scale_averagewater2+scale_int,
phiformula = ~1,
pformula = ~ 1,
data = umf, keyfun = "hazard", mixture="NB",se = T, output="abund")
save(model, file="C:/Users/avand/Documents/unmarked/2014_models.Rdata")
list  = fitList(model)
mm14 = modSel(list)
mm14
load("C:/Users/avand/Documents/unmarked/2014_models.Rdata")
m14 <- model
names14 <- names(m14)
cov14 <- read.csv("C:/Users/avand/Documents/data/2014_cov.csv")
###
## mod avg
###
modavg14s <- modavg(m14, parm="scale_short", parm.type="lambda") #NOT
modavg14i <- modavg(m14, parm="scale_int", parm.type="lambda") #NOT
modavg14w <- modavg(m14, parm="scale_averagewater", parm.type="lambda", exclude=list("~scale_averagewater+scale_averagewater2"))
modavg14p <- modavg(m14, parm="scale_pe", parm.type="lambda") #NOT
## averagewater
scale_averagewater14 <- data.frame(scale_averagewater=seq(min(cov14$scale_averagewater), max(cov14$scale_averagewater), length.out=50),scale_short=mean(cov14$scale_short), scale_int=mean(cov14$scale_int), averagewater=seq(min(cov14$averagewater), max(cov14$averagewater), length.out=50),scale_pe=mean(cov14$scale_pe))
scale_averagewater14$scale_averagewater2 <- scale_averagewater14$scale_averagewater^2
Modnames <- names(m14)
pred_averagewater_14 <- modavgPred(cand.set=m14, modnames=Modnames,newdata=scale_averagewater14, parm.type="lambda",type="response", uncond.se="old")
averagewater14 <- cbind(scale_averagewater14, pred_averagewater_14)
averagewater14$sd <- averagewater14$uncond.se * sqrt(50)
averagewater14$ci <- qnorm(0.975)*averagewater14$sd/sqrt(50)
averagewater14$upper <- averagewater14$mod.avg.pred + averagewater14$ci
averagewater14$lower <- averagewater14$mod.avg.pred - averagewater14$ci
(w14 <- ggplot()+theme_krementz()+ylab("2014 \nSora per hectare")+xlab("Average Water Depth (cm)")+
geom_line(data=averagewater14, aes(x=averagewater, y=upper),linetype=2, color="black")+
geom_line(data=averagewater14, aes(x=averagewater, y=lower),linetype=2, color="black")+
geom_line(data=averagewater14, aes(x=averagewater, y=mod.avg.pred), lwd=2))
grid.arrange(s12, s15, i13, w15, w14, ncol=2)
grid.arrange(s12, s15, i13, blankPanel,w15, w14, ncol=2)
blankPanel<-grid.rect(gp=gpar(col="white"))
library(grid)
blankPanel<-grid.rect(gp=gpar(col="white"))
grid.arrange(s12, s15, i13, blankPanel,w15, w14, ncol=2)
png(filename="C:/Users/avand/Documents/manuscripts/Dissertation_Chapter_2_Habitat_Sora/figure_1_betas.png", height=1000, width=1000)
grid.arrange(s12, s15, i13, blankPanel,w15, w14, ncol=2)
dev.off()
library(unmarked)
load("C:/Users/avand/Documents/unmarked/2012_models.Rdata")
m12 <- model
load("C:/Users/avand/Documents/unmarked/2013_models.Rdata")
m13 <- model
load("C:/Users/avand/Documents/unmarked/2014_models.Rdata")
m14 <- model
load("C:/Users/avand/Documents/unmarked/2015_models.Rdata")
m15 <- model
list12  = fitList(m12)
mm12 = modSel(list12)
mm12
list13  = fitList(m13)
mm13 = modSel(list13)
mm13
list14  = fitList(m14)
mm14 = modSel(list14)
mm14
list15  = fitList(m15)
mm15 = modSel(list15)
mm15
dat <- read.csv("C:/Users/avand/Documents/data/all_surveys.csv")
dat$sorapres <- ifelse(dat$sora>=1,1,0)
sum(dat$sorapres)
nrow(dat)
load("C:/Users/avand/Documents/unmarked/2012_models.Rdata")
m12 <- model
load("C:/Users/avand/Documents/unmarked/2013_models.Rdata")
m13 <- model
load("C:/Users/avand/Documents/unmarked/2014_models.Rdata")
m14 <- model
load("C:/Users/avand/Documents/unmarked/2015_models.Rdata")
m15 <- model
load("C:/Users/avand/Documents/unmarked/2012_models.Rdata")
m12 <- model
load("C:/Users/avand/Documents/unmarked/2013_models.Rdata")
m13 <- model
load("C:/Users/avand/Documents/unmarked/2014_models.Rdata")
m14 <- model
load("C:/Users/avand/Documents/unmarked/2015_models.Rdata")
m15 <- model
par12 <- parboot(m12$global, statistic=fitstats, nsim=3) ## still errors out
fitstats <- function(fm) {
observed <- getY(fm@data)
expected <- fitted(fm)
resids <- residuals(fm)
sse <- sum(resids^2)
chisq <- sum((observed - expected)^2 / expected)
freeTuke <- sum((sqrt(observed) - sqrt(expected))^2)
out <- c(SSE=sse, Chisq=chisq, freemanTukey=freeTuke)
return(out)
}
load("C:/Users/avand/Documents/unmarked/2012_models.Rdata")
m12 <- model
load("C:/Users/avand/Documents/unmarked/2013_models.Rdata")
m13 <- model
load("C:/Users/avand/Documents/unmarked/2014_models.Rdata")
m14 <- model
load("C:/Users/avand/Documents/unmarked/2015_models.Rdata")
m15 <- model
par12 <- parboot(m12$global, statistic=fitstats, nsim=3) ## still errors out
par12
par13 <- parboot(m13$global, statistic=fitstats, nsim=3) ## still errors out
par13
######################
par14 <- parboot(m14$global, statistic=fitstats, nsim=3) ## still errors out
par14
##################
par15 <- parboot(m15$global, statistic=fitstats, nsim=3) ## still errors out
models <- c("~1",
"~scale_averagewater",
"~scale_averagewater+scale_averagewater2",
"~scale_short",
"~scale_int",
"~scale_short+scale_int",
"~scale_pe")
library(unmarked)
sora <- read.csv('C:/Users/avanderlaar/Documents/data/2013_sora.csv', header=T)
cov <- read.csv('C:/Users/avanderlaar/Documents/data/2013_cov.csv', header=T)
sora <- sora[order(sora$impound),]
cov <- cov[order(cov$impound),]
cov$scale_short2 <- cov$scale_short^2
cov$scale_int2 <- cov$scale_int^2
cov$scale_averagewater2 <- cov$scale_averagewater^2
sora <- sora[,2:31]
cutpt = as.numeric(c(0,1,2,3,4,5))
umf = unmarkedFrameGDS(y=sora,
numPrimary=6,
siteCovs = cov,
survey="line",
dist.breaks=cutpt,
unitsIn="m",
tlength=cov$length
)
model <- list()
for(i in 1:length(models)){
print(i)
model[[models[[i]]]] = gdistsamp(lambdaformula = as.formula(models[i]),
phiformula = ~1,
pformula = ~1,
data = umf, keyfun = "hazard", mixture="NB",se = T, output="abund")
}
model$global <- gdistsamp(lambdaformula = ~scale_short+scale_averagewater++scale_averagewater2+scale_pe+scale_int,
phiformula = ~1,
pformula = ~ 1,
data = umf, keyfun = "hazard", mixture="NB",se = T, output="abund")
save(model, file="C:/Users/avanderlaar/Documents/unmarked/2013_models.Rdata")
list  = fitList(model)
model = modSel(list)
model
models <- c("~1",
"~scale_averagewater",
"~scale_averagewater+scale_averagewater2",
"~scale_short",
"~scale_int",
"~scale_short+scale_int",
"~scale_pe")
library(unmarked)
sora <- read.csv('C:/Users/avand/Documents/data/2013_sora.csv', header=T)
cov <- read.csv('C:/Users/avand/Documents/data/2013_cov.csv', header=T)
sora <- sora[order(sora$impound),]
cov <- cov[order(cov$impound),]
cov$scale_short2 <- cov$scale_short^2
cov$scale_int2 <- cov$scale_int^2
cov$scale_averagewater2 <- cov$scale_averagewater^2
sora <- sora[,2:31]
cutpt = as.numeric(c(0,1,2,3,4,5))
umf = unmarkedFrameGDS(y=sora,
numPrimary=6,
siteCovs = cov,
survey="line",
dist.breaks=cutpt,
unitsIn="m",
tlength=cov$length
)
model <- list()
for(i in 1:length(models)){
print(i)
model[[models[[i]]]] = gdistsamp(lambdaformula = as.formula(models[i]),
phiformula = ~1,
pformula = ~1,
data = umf, keyfun = "hazard", mixture="NB",se = T, output="abund")
}
model$global <- gdistsamp(lambdaformula = ~scale_short+scale_averagewater++scale_averagewater2+scale_pe+scale_int,
phiformula = ~1,
pformula = ~ 1,
data = umf, keyfun = "hazard", mixture="NB",se = T, output="abund")
save(model, file="C:/Users/avand/Documents/unmarked/2013_models.Rdata")
list  = fitList(model)
model = modSel(list)
model
models <- c("~1",
"~scale_averagewater",
"~scale_averagewater+scale_averagewater2",
"~scale_short",
"~scale_int",
"~scale_short+scale_int")
library(unmarked)
sora <- read.csv('C:/Users/avand/Documents/data/2012_sora.csv', header=T)
cov <- read.csv('C:/Users/avand/Documents/data/2012_cov.csv', header=T)
sora <- sora[order(sora$impound),]
cov <- cov[order(cov$impound),]
cov$scale_short2 <- cov$scale_short^2
cov$scale_int2 <- cov$scale_int^2
cov$scale_averagewater2 <- cov$scale_averagewater^2
sora <- sora[,2:16]
cutpt = as.numeric(c(0,1,2,3,4,5))
umf = unmarkedFrameGDS(y=sora,
numPrimary=3,
siteCovs = cov,
survey="line",
dist.breaks=cutpt,
unitsIn="m",
tlength=cov$length
)
model <- list()
for(i in 1:length(models)){
print(i)
model[[models[[i]]]] = gdistsamp(lambdaformula = as.formula(models[i]),
phiformula = ~1,
pformula = ~1,
data = umf, keyfun = "hazard", mixture="NB",se = T, output="abund")
}
model$global <- gdistsamp(lambdaformula = ~scale_short+scale_averagewater++scale_averagewater2+scale_int,
phiformula = ~1,
pformula = ~ 1,
data = umf, keyfun = "hazard", mixture="NB",se = T, output="abund")
save(model, file="C:/Users/avand/Documents/unmarked/2012_models.Rdata")
list  = fitList(model)
model = modSel(list)
model
load("C:/Users/avand/Documents/unmarked/2012_models.Rdata")
m12 <- model
load("C:/Users/avand/Documents/unmarked/2013_models.Rdata")
m13 <- model
load("C:/Users/avand/Documents/unmarked/2014_models.Rdata")
m14 <- model
load("C:/Users/avand/Documents/unmarked/2015_models.Rdata")
m15 <- model
par12 <- parboot(m12$global, statistic=fitstats, nsim=10) ## still errors out
par12
par13 <- parboot(m13$global, statistic=fitstats, nsim=10) ## still errors out
par13
par15 <- parboot(m15$global, statistic=fitstats, nsim=10) ## still errors out
par15
par14 <- parboot(m14$global, statistic=fitstats, nsim=10) ## still errors out
par14
fitstat <- function(y, Ey){
sum((sqrt(y) - sqrt(Ey)))
}
